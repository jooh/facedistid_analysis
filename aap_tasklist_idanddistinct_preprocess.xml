<?xml version="1.0" encoding="utf-8"?>
<aap>
    <tasklist>
        <!-- initialisation modules run every time -->
        <initialisation>
            <module><name>aamod_checkparameters</name></module>
            <module><name>aamod_evaluatesubjectnames</name></module>
            <module><name>aamod_make_subjects_short</name></module>
            <module><name>aamod_study_init</name></module>
            <module><name>aamod_newsubj_init</name></module>
        </initialisation>

        <!-- main modules run once only (unless done flag is removed) -->
        <main>
            <!-- find DICOMs -->
            <module><name>aamod_autoidentifyseries_timtrio</name></module>
            <module><name>aamod_get_dicom_epi</name></module>
            <module><name>aamod_get_dicom_structural</name></module>
            <!-- convert DICOM to NIFTI -->
            <module><name>aamod_copystructural</name></module>
            <module><name>aamod_convert_epis</name></module>
            <module><name>aamod_make_epis_float</name></module>
            <module><name>aamod_tsdiffana</name></module>
            <!-- functional preprocessing and diagnostics-->
            <!-- still need to evaluate if this thing actually helps -->
            <module><name>aamod_realign</name></module>
            <!-- structural preprocessing -->
            <module><name>aamod_denoiseANLM</name></module>
            <module><name>aamod_coreg_noss</name></module>
            <module><name>aamod_bet_premask</name></module>
            <module><name>aamod_bet</name>
                <extraparameters>
                    <aap><tasklist><currenttask><settings>
                                    <!-- we want a generous brain
                                         extraction (default .5) -->
                                    <bet_f_parameter>.3</bet_f_parameter>
                    </settings></currenttask></tasklist></aap>
                </extraparameters>
            </module>
            <module><name>aamod_bet_epi_reslicing</name></module>
            <module><name>aamod_norm_noss</name></module>
            <module><name>aamod_meanstructural</name></module>
            <module><name>aamod_pilab_mask_importbet</name></module>
            <!-- TODO - we can put some module here that takes all the
                 files we want as input, with a high garbage threshold.
                 Then we can run garbage collection and wipe all the
                 previous stages --> 
            <module><name>aamod_pilab_sharedata</name></module>
     </main>
 </tasklist>
</aap>
